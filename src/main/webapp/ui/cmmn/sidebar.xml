<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ev="http://www.w3.org/2001/xml-events"
    xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head meta_screenName="좌측 사이드바 페이지">
        <w2:type>COMPONENT</w2:type>
        <w2:buildDate/>
        <w2:MSA/>
        <xf:model>
            <w2:dataCollection baseNode="map"/>
            <w2:workflowCollection/>
        </xf:model>
        <w2:layoutInfo/>
        <w2:publicInfo method=""/>
        <style type="text/css">
            .sidebar-container {
                width: 250px;
                height: calc(100vh - 90px);
                background: white;
                color: #333;
                position: fixed;
                left: 0;
                top: 90px;
                z-index: 1000;
                overflow-y: auto;
                border-bottom: 1px solid #e0e0e0;
                display: flex;
                flex-direction: column;
                padding: 0 10px;
            }

            .menu-list {
                padding: 20px 0 0 0;
                margin: 0;
                flex: 1;
                display: flex;
                flex-direction: column;
                align-items: center;
            }

            .menu-item {
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 16px 20px;
                text-decoration: none;
                cursor: pointer;
                transition: all 0.2s ease;
                font-size: 15px;
                font-weight: bold;
                position: relative;
                background: white;
                border: none;
                width: 85%;
                text-align: left;
                outline: none;
                color: #333;
                border-radius: 10px;
                margin-bottom: 8px;
            }

            .menu-item:hover {
                background: #5C5DB0;
                color: white;
                font-weight: bold;
                border-radius: 10px;
            }

            .menu-item.active {
                background: #1C3D6B !important;
                color: white !important;
                font-weight: bold !important;
                border-radius: 10px !important;
                box-shadow: 0 2px 8px rgba(92, 93, 176, 0.3) !important;
            }

            .customer-center {
                background: #4A90E2;
                color: white;
                padding: 10px;
                border-radius: 15px;
                margin: 20px auto;
                margin-top: auto;
                flex-shrink: 0;
                width: 85%;
                text-align: left;
            }

            .customer-center-header {
                display: flex;
                align-items: center;
                justify-content: space-between;
                margin-bottom: 15px;
            }

            .customer-center-title {
                font-size: 16px;
                font-weight: bold;
            }

            .customer-center-icon {
                width: 40px;
                height: 40px;
                background: rgba(255, 255, 255, 0.2);
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 18px;
            }

            .customer-center-content {
                font-size: 13px;
                line-height: 1.6;
            }

            .customer-center-phone {
                font-size: 16px;
                font-weight: bold;
                margin: 8px 0;
            }

            .customer-center-email {
                font-size: 13px;
                margin-top: 10px;
            }

            .customer-center-desc {
                font-size: 12px;
                margin: 5px 0;
            }
        </style>
        <script lazy="false" type="text/javascript"><![CDATA[
scwin.activeMenuId = null;

scwin.onpageload = function() {
    
    // DOM이 완전히 로드된 후 디버깅 정보 출력
    setTimeout(function() {
        scwin.debugAvailableMenuIds();
        
        // 부모 프레임에서 현재 활성 메뉴 정보 확인
        if (window.parent && window.parent.scwin && window.parent.scwin.currentActiveMenuId) {
            var currentMenuId = window.parent.scwin.currentActiveMenuId;
            scwin.setActiveMenu(currentMenuId);
        } else {
            // 기본적으로 첫 번째 메뉴 활성화
            scwin.setActiveMenu("menu_duty_manage");
        }
    }, 300);
};

// 메뉴 활성화 설정
scwin.setActiveMenu = function(menuId) {
    try {
        
        // 모든 메뉴 비활성화
        var menuItems = document.querySelectorAll('.menu-item');
        for (var i = 0; i < menuItems.length; i++) {
            menuItems[i].classList.remove('active');
        }
        
        // 강력한 메뉴 찾기 함수 사용
        var selectedMenu = scwin.findMenuElement(menuId);
        
        if (selectedMenu) {
            selectedMenu.classList.add('active');
            scwin.activeMenuId = menuId;
            
            // 부모 프레임에 현재 활성 메뉴 정보 전달
            if (window.parent && window.parent.scwin) {
                window.parent.scwin.currentActiveMenuId = menuId;
            }
        } else {
            // 사용 가능한 메뉴 ID들 출력
            scwin.debugAvailableMenuIds();
        }
    } catch (e) {
    }
};

// 강력한 메뉴 요소 찾기 함수
scwin.findMenuElement = function(menuId) {
    var element = null;
    
    // 1. 정확한 ID 매칭
    element = document.getElementById(menuId);
    if (element) {
        return element;
    }
    
    // 2. WebSquare 접두사 고려
    element = document.getElementById('mf_' + menuId);
    if (element) {
        return element;
    }
    
    // 3. querySelector로 검색
    element = document.querySelector('#' + menuId);
    if (element) {
        return element;
    }
    
    // 4. mf_ 접두사와 함께 querySelector 검색
    element = document.querySelector('#mf_' + menuId);
    if (element) {
        return element;
    }
    
    // 5. 부분 ID 매칭으로 검색
    element = document.querySelector('[id*="' + menuId + '"]');
    if (element) {
        return element;
    }
    
    // 6. 라벨 텍스트로 검색 (마지막 수단)
    var menuItems = document.querySelectorAll('.menu-item');
    for (var i = 0; i < menuItems.length; i++) {
        var label = menuItems[i].querySelector('xf\\:label, label');
        if (label && label.textContent && label.textContent.trim() === getMenuLabel(menuId)) {
            return menuItems[i];
        }
    }
    
    return null;
};

// 메뉴 ID에 해당하는 라벨 텍스트 반환
scwin.getMenuLabel = function(menuId) {
    var menuLabels = {
        'menu_duty_manage': '근무자 관리',
        'menu_schedule_manage': '스케줄 관리',
        'menu_my_schedule': '내 스케줄 보기',
        'menu_work_input': '희망 근무 입력'
    };
    return menuLabels[menuId] || '';
};

// 사용 가능한 메뉴 ID 디버깅 함수
scwin.debugAvailableMenuIds = function() {
    var menuItems = document.querySelectorAll('.menu-item');
    
    for (var i = 0; i < menuItems.length; i++) {
    }
    
    // 모든 ID가 있는 요소들도 출력
    var allElementsWithId = document.querySelectorAll('[id]');
    for (var i = 0; i < Math.min(allElementsWithId.length, 20); i++) {
    }
};

// 부모 프레임과의 통신 함수 (mkduty.xml에서 설정됨)
scwin.onMenuClick = null;

// 메뉴 클릭 처리
scwin.handleMenuClick = function(menuId, menuUrl, menuTitle) {
    try {
        
        // 먼저 메뉴 활성화
        scwin.setActiveMenu(menuId);
        
        // 부모 프레임에 메뉴 클릭 이벤트 전달
        if (scwin.onMenuClick) {
            scwin.onMenuClick(menuId, menuUrl, menuTitle);
        } else {
        }
        
        // 활성 상태 유지를 위한 추가 처리
        setTimeout(function() {
            scwin.setActiveMenu(menuId);
        }, 100);
        
    } catch (e) {
    }
};

// 근무자 관리 메뉴 클릭
scwin.goDutyManage = function() {
    scwin.setActiveMenu("menu_duty_manage");
    scwin.handleMenuClick("menu_duty_manage", "/InsWebApp/ui/nurse/NurseManage.xml", "근무자 관리");
};

// 스케줄 관리 메뉴 클릭
scwin.goScheduleManage = function() {
    scwin.setActiveMenu("menu_schedule_manage");
    scwin.handleMenuClick("menu_schedule_manage", "/InsWebApp/ui/schedule/MakeDuty.xml", "스케줄 관리");
};

// 내 스케줄 보기 메뉴 클릭
scwin.goMySchedule = function() {
    scwin.setActiveMenu("menu_my_schedule");
    scwin.handleMenuClick("menu_my_schedule", "/InsWebApp/ui/duty/MySchedule.xml", "내 스케줄 보기");
};

// 희망 근무 입력 메뉴 클릭
scwin.goWorkInput = function() {
    scwin.setActiveMenu("menu_work_input");
    scwin.handleMenuClick("menu_work_input", "/InsWebApp/ui/duty/HopeWork.xml", "희망 근무 입력");
};
]]></script>

    </head>
    <body ev:onpageload="scwin.onpageload">
        <xf:group class="sidebar-container">
            <!-- 메뉴 리스트 -->
            <xf:group class="menu-list">
                <xf:trigger id="menu_duty_manage" class="menu-item" ev:onclick="scwin.goDutyManage">
                    <xf:label>근무자 관리</xf:label>
                </xf:trigger>
                <xf:trigger id="menu_schedule_manage" class="menu-item" ev:onclick="scwin.goScheduleManage">
                    <xf:label>스케줄 관리</xf:label>
                </xf:trigger>
                <xf:trigger id="menu_my_schedule" class="menu-item" ev:onclick="scwin.goMySchedule">
                    <xf:label>내 스케줄 보기</xf:label>
                </xf:trigger>
                <xf:trigger id="menu_work_input" class="menu-item" ev:onclick="scwin.goWorkInput">
                    <xf:label>희망 근무 입력</xf:label>
                </xf:trigger>
            </xf:group>

            <!-- 고객센터 섹션 -->
            <xf:group class="customer-center">
                <xf:group class="customer-center-header">
                    <w2:textbox class="customer-center-title" label="Customer Center" id=""></w2:textbox>
                    <xf:group class="customer-center-icon">
                        <w2:textbox label="🎧" style="font-size:18px;" id=""></w2:textbox>
                    </xf:group>
                </xf:group>
                <xf:group class="customer-center-content">
                    <w2:textbox label="제품문의" id=""></w2:textbox>
                    <xf:group class="customer-center-phone">
                        <w2:textbox label="010-1234-5678" id=""></w2:textbox>
                    </xf:group>
                    <w2:textbox class="customer-center-desc" label="고객님의 소중한 의견을 들어주세요" id=""></w2:textbox>
                    <w2:textbox class="customer-center-desc" label="제품 문의 및 기술 지원" id=""></w2:textbox>
                    <xf:group class="customer-center-email">
                        <w2:textbox label="ows0710@gmail.com" id=""></w2:textbox>
                    </xf:group>
                </xf:group>
            </xf:group>
        </xf:group>
    </body>
</html>
