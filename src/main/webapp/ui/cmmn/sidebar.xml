<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ev="http://www.w3.org/2001/xml-events"
    xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head>
        <w2:type>COMPONENT</w2:type>
        <w2:buildDate/>
        <w2:MSA/>
        <xf:model>
            <w2:dataCollection baseNode="map"/>
            <w2:workflowCollection/>
        </xf:model>
        <w2:layoutInfo/>
        <w2:publicInfo method=""/>
        <style type="text/css">
            .sidebar-container {
                width: 250px;
                height: calc(100vh - 90px);
                background: white;
                color: #333;
                position: fixed;
                left: 0;
                top: 90px;
                z-index: 1000;
                overflow-y: auto;
                border-bottom: 1px solid #e0e0e0;
                display: flex;
                flex-direction: column;
            }

            .menu-list {
                padding: 0;
                margin: 0;
                flex: 1;
            }

            .menu-item {
                display: flex;
                align-items: center;
                padding: 16px 20px;
                text-decoration: none;
                cursor: pointer;
                transition: all 0.2s ease;
                font-size: 15px;
                font-weight: bold;
                position: relative;
                background: white;
                border: none;
                width: 100%;
                text-align: left;
                outline: none;
                color: #333;
            }

            .menu-item:hover {
                border-radius: 10px;
                margin: 0 10px;
            }

            .menu-item.active {
                background: #1C3D6B;
                color: white;
                font-weight: bold;
                border-radius: 10px;
                margin: 0 10px;
            }

            .customer-center {
                background: #4A90E2;
                color: white;
                padding: 20px;
                border-radius: 15px;
                margin: 20px;
                margin-top: auto;
                flex-shrink: 0;
            }

            .customer-center-header {
                display: flex;
                align-items: center;
                justify-content: space-between;
                margin-bottom: 15px;
            }

            .customer-center-title {
                font-size: 16px;
                font-weight: bold;
            }

            .customer-center-icon {
                width: 40px;
                height: 40px;
                background: rgba(255, 255, 255, 0.2);
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 18px;
            }

            .customer-center-content {
                font-size: 13px;
                line-height: 1.6;
            }

            .customer-center-phone {
                font-size: 16px;
                font-weight: bold;
                margin: 8px 0;
            }

            .customer-center-email {
                font-size: 13px;
                margin-top: 10px;
            }

            .customer-center-desc {
                font-size: 12px;
                margin: 5px 0;
            }
        </style>
        <script lazy="false" type="text/javascript"><![CDATA[
scwin.onpageload = function() {
    console.log("ÏÇ¨Ïù¥ÎìúÎ∞î Î°úÎìú ÏôÑÎ£å");

    // DOMÏù¥ ÏôÑÏ†ÑÌûà Î°úÎìúÎê† ÎïåÍπåÏßÄ Ïó¨Îü¨ Î≤à ÏãúÎèÑ
    scwin.applyActiveMenu();
};

scwin.applyActiveMenu = function() {
    var attempts = 0;
    var maxAttempts = 10;
    
    var checkAndApply = function() {
        attempts++;
        console.log("Î©îÎâ¥ ÌôúÏÑ±Ìôî ÏãúÎèÑ:", attempts + "/" + maxAttempts);
        
        // Î™®Îì† Î©îÎâ¥ ÏöîÏÜåÍ∞Ä Î°úÎìúÎêòÏóàÎäîÏßÄ ÌôïÏù∏
        var allMenusExist = document.getElementById("menu_duty_manage") && 
                           document.getElementById("menu_schedule_manage") && 
                           document.getElementById("menu_my_schedule") && 
                           document.getElementById("menu_work_input");
        
        if (allMenusExist) {
            console.log("‚úÖ Î™®Îì† Î©îÎâ¥ ÏöîÏÜå ÌôïÏù∏Îê®");
            
            // Ïù¥Ï†ÑÏóê Ï†ÄÏû•Ìïú Î©îÎâ¥ IDÎ•º Í∞ÄÏ†∏ÏôÄÏÑú active Ï†ÅÏö©
            var activeMenuId = localStorage.getItem("activeMenuId");
            console.log("Ï†ÄÏû•Îêú activeMenuId:", activeMenuId);
            
            if (activeMenuId) {
                // Ï†ÄÏû•Îêú Î©îÎâ¥ ÌôúÏÑ±Ìôî
                var selectedMenu = document.getElementById(activeMenuId);
                if (selectedMenu) {
                    selectedMenu.classList.add("active");
                    console.log("‚úÖ Î©îÎâ¥ active Ï†ÅÏö© ÏÑ±Í≥µ:", activeMenuId);
                } else {
                    console.warn("‚ö†Ô∏è Ï†ÄÏû•Îêú Î©îÎâ¥ IDÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏùå:", activeMenuId);
                }
            } else {
                console.log("Ï†ÄÏû•Îêú activeMenuIdÍ∞Ä ÏóÜÏäµÎãàÎã§.");
            }
        } else {
            console.log("Î©îÎâ¥ ÏöîÏÜåÎì§Ïù¥ ÏïÑÏßÅ Î°úÎìúÎêòÏßÄ ÏïäÏùå, Ïû¨ÏãúÎèÑ...");
            
            // ÏïÑÏßÅ Î™®Îì† ÏöîÏÜåÍ∞Ä Î°úÎìúÎêòÏßÄ ÏïäÏïòÍ≥† ÏãúÎèÑ ÌöüÏàòÍ∞Ä ÎÇ®ÏïòÏúºÎ©¥ Îã§Ïãú ÏãúÎèÑ
            if (attempts < maxAttempts) {
                setTimeout(checkAndApply, 500);
            } else {
                console.warn("‚ö†Ô∏è ÏµúÎåÄ ÏãúÎèÑ ÌöüÏàò Ï¥àÍ≥º. DOM Î°úÎî© ÌÉÄÏûÑÏïÑÏõÉ");
            }
        }
    };
    
    // Ï¶âÏãú ÏãúÎèÑ
    checkAndApply();
};

scwin.navigateMenu = function(menuId, targetPage) {
    try {
        // Î™®Îì† Î©îÎâ¥ ÎπÑÌôúÏÑ±Ìôî
        var menuItems = document.querySelectorAll('.menu-item');
        for (var i = 0; i < menuItems.length; i++) {
            menuItems[i].classList.remove('active');
        }
        
        // ÏÑ†ÌÉùÌïú Î©îÎâ¥ ÌôúÏÑ±Ìôî
        var selectedMenu = document.getElementById(menuId);
        if (selectedMenu) {
            selectedMenu.classList.add('active');
        }
        
        // ÌÅ¥Î¶≠Ìïú Î©îÎâ¥ ID Ï†ÄÏû•
        localStorage.setItem("activeMenuId", menuId);
        
        console.log("Î©îÎâ¥ ÌÅ¥Î¶≠:", menuId);

        // ÌéòÏù¥ÏßÄ Ïù¥Îèô
        window.location.href = targetPage;

    } catch (error) {
        console.error("Î©îÎâ¥ ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò Ïò§Î•ò:", error);
        alert("ÌéòÏù¥ÏßÄ Ïù¥Îèô Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§: " + error.message);
    }
};

// Í∑ºÎ¨¥Ïûê Í¥ÄÎ¶¨ Î©îÎâ¥ ÌÅ¥Î¶≠
scwin.goDutyManage = function() {
    scwin.navigateMenu("menu_duty_manage", "http://localhost:9093/InsWebApp/websquare/websquare.html?w2xPath=/InsWebApp/ui/layout/mkduty.xml");
};

// Ïä§ÏºÄÏ§Ñ Í¥ÄÎ¶¨ Î©îÎâ¥ ÌÅ¥Î¶≠
scwin.goScheduleManage = function() {
    scwin.navigateMenu("menu_schedule_manage", "http://localhost:9093/InsWebApp/websquare/websquare.html?w2xPath=/InsWebApp/ui/layout/mkmyschedule.xml");
};

// ÎÇ¥ Ïä§ÏºÄÏ§Ñ Î≥¥Í∏∞ Î©îÎâ¥ ÌÅ¥Î¶≠
scwin.goMySchedule = function() {
    scwin.navigateMenu("menu_my_schedule", "http://localhost:9093/InsWebApp/websquare/websquare.html?w2xPath=/InsWebApp/ui/layout/mkmyschedule.xml");
};

// Ìù¨Îßù Í∑ºÎ¨¥ ÏûÖÎ†• Î©îÎâ¥ ÌÅ¥Î¶≠
scwin.goWorkInput = function() {
    scwin.navigateMenu("menu_work_input", "http://localhost:9093/InsWebApp/websquare/websquare.html?w2xPath=/InsWebApp/ui/layout/mkhope.xml");
};
]]></script>

    </head>
    <body ev:onpageload="scwin.onpageload">
        <xf:group class="sidebar-container">
            <!-- Î©îÎâ¥ Î¶¨Ïä§Ìä∏ -->
            <xf:group class="menu-list">
                <xf:trigger id="menu_duty_manage" class="menu-item" ev:onclick="scwin.goDutyManage">
                    <xf:label>Í∑ºÎ¨¥Ïûê Í¥ÄÎ¶¨</xf:label>
                </xf:trigger>
                <xf:trigger id="menu_schedule_manage" class="menu-item" ev:onclick="scwin.goScheduleManage">
                    <xf:label>Ïä§ÏºÄÏ§Ñ Í¥ÄÎ¶¨</xf:label>
                </xf:trigger>
                <xf:trigger id="menu_my_schedule" class="menu-item" ev:onclick="scwin.goMySchedule">
                    <xf:label>ÎÇ¥ Ïä§ÏºÄÏ§Ñ Î≥¥Í∏∞</xf:label>
                </xf:trigger>
                <xf:trigger id="menu_work_input" class="menu-item" ev:onclick="scwin.goWorkInput">
                    <xf:label>Ìù¨Îßù Í∑ºÎ¨¥ ÏûÖÎ†•</xf:label>
                </xf:trigger>
            </xf:group>

            <!-- Í≥†Í∞ùÏÑºÌÑ∞ ÏÑπÏÖò -->
            <xf:group class="customer-center">
                <xf:group class="customer-center-header">
                    <w2:textbox class="customer-center-title" label="Customer Center" id=""></w2:textbox>
                    <xf:group class="customer-center-icon">
                        <w2:textbox label="üéß" style="font-size:18px;" id=""></w2:textbox>
                    </xf:group>
                </xf:group>
                <xf:group class="customer-center-content">
                    <w2:textbox label="Ï†úÌíàÎ¨∏Ïùò" id=""></w2:textbox>
                    <xf:group class="customer-center-phone">
                        <w2:textbox label="010-1234-5678" id=""></w2:textbox>
                    </xf:group>
                    <w2:textbox class="customer-center-desc" label="Í≥†Í∞ùÎãòÏùò ÏÜåÏ§ëÌïú ÏùòÍ≤¨ÏùÑ Îì§Ïñ¥Ï£ºÏÑ∏Ïöî" id=""></w2:textbox>
                    <w2:textbox class="customer-center-desc" label="Ï†úÌíà Î¨∏Ïùò Î∞è Í∏∞Ïà† ÏßÄÏõê" id=""></w2:textbox>
                    <xf:group class="customer-center-email">
                        <w2:textbox label="ows0710@gmail.com" id=""></w2:textbox>
                    </xf:group>
                </xf:group>
            </xf:group>
        </xf:group>
    </body>
</html>
