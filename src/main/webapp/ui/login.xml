<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ev="http://www.w3.org/2001/xml-events"
    xmlns:w2="http://www.inswave.com/websquare" xmlns:xf="http://www.w3.org/2002/xforms">
    <head meta_screenName="로그인 페이지">
        <w2:type>COMPONENT</w2:type>
        <w2:buildDate/>
        <w2:MSA/>
        <xf:model>
        	<w2:dataCollection baseNode="map">
        		<w2:dataMap baseNode="map" id="dma_login">
        			<w2:keyInfo>
        				<w2:key dataType="text" name="id" id="id"></w2:key>
        				<w2:key dataType="text" name="pw" id="pw"></w2:key>
        			</w2:keyInfo>
        		</w2:dataMap>
        	</w2:dataCollection>
        	<w2:workflowCollection />
        	<xf:submission id="sbm_login" action="/InsWebApp/CmmLogin.pwkjson" method="post" mediatype="application/json" ref='data:json,{"id":"dma_login","key":"elData"}' target=""
        		encoding="UTF-8" instance="" replace="" errorHandler="" customHandler="" mode="asynchronous" processMsg="로그인 처리중..." ev:submit=""
        		ev:submitdone="scwin.sbm_login_submitdone" ev:submiterror="" abortTrigger="">
        	</xf:submission>
        </xf:model>
        <w2:layoutInfo/>
        <w2:publicInfo method=""/>
        <script lazy="false" type="text/javascript"><![CDATA[
scwin.onpageload = function() {
    // $p.url(w2xPath, options)

	//$c.win.moveUrl("/ui/dept/Dept.xml"); // 페이지 이동 메소드
};

scwin.ui_id_onkeydown = function (e) {
    if (e.keyCode === 13) { // Enter 키
        ui_password.focus();
    }
};

scwin.ui_password_onkeydown = function (e) {
    if (e.keyCode === 13) { // Enter 키
        btn_login.focus();
        scwin.inputCheck();
    }
};

// 로그인 버튼 클릭시 로그인 처리
scwin.btn_login_onclick = function (e) {
    
    $c.sbm.execute(sbm_login);
};

// 정상 처리 후 dept.xml 이동처리
scwin.sbm_login_submitdone = function (e) {
    
    var elHeader = e.responseJSON.elHeader; // 응답 전문 elHeader
    if(elHeader != "" && elHeader != null && elHeader != "undefined") {
        if(elHeader.resSuc == true) {
            //setCookie("userId", elHeader.userId);
            //moveLocation("html/emp/empList.html");
            //$p.url("/ui/dept/Dept.xml");
            //$c.win.moveUrl("/InsWebApp/ui/dept/Dept.xml");
            //location.href = "/InsWebApp/websquare/websquare.html?w2xPath=/InsWebApp/ui/dept/Dept.xml";
            location.href = "/InsWebApp/websquare/websquare.html?w2xPath=/InsWebApp/main/mainWrapper.xml";
        } else {
            //exceptionAlert("로그인", elHeader.resCode, elHeader.resMsg);
            alert(elHeader.resMsg);
        }
        
    }
};

scwin.inputCheck = function() {
    var id = ui_id.getValue();
    var pw = ui_password.getValue();

    if (!id) {
        alert("아이디를 입력하세요.");
        ui_id.focus();
        return false;
    }

    if (!pw) {
        alert("패스워드를 입력하세요.");
        ui_password.focus();
        return false;
    }

};
]]></script>
    </head>
    <body ev:onpageload="scwin.onpageload">
    	<xf:group class="sub_contents" id="" meta_snippetCategory="00_화면시작" meta_snippetKeyComponent="true" meta_snippetName="0_01 페이지시작"
    		style="">
    		<xf:group class="pgtbox" id="" meta_snippetCategory="02_타이틀" meta_snippetKeyComponent="true" meta_snippetName="2_01 페이지타이틀"
    			style="">
    			<w2:textbox class="pgt_tit" id="" label="로그인" style="" tagname=""></w2:textbox>
    			<xf:group class="breadcrumb" id="" style="">
    				<xf:group id="" style="" tagname="ul">
    					<xf:group id="" style="" tagname="li"></xf:group>
    				</xf:group>
    			</xf:group>
    		</xf:group>
    		<xf:group class="schbox" id="" meta_snippetCategory="03_조회영역" meta_snippetKeyComponent="true" meta_snippetName="3_01 조회조건1행"
    			style="">
    			<xf:group class="schbox_inner" id="" style="padding: 10px;">
    				<w2:span id="" label="아이디: " meta_snippetCategory="10_입력폼" meta_snippetKeyComponent="true"
    					meta_snippetName="10_16 출력텍스트" style="">
    				</w2:span>
    				<xf:input class="" id="ui_id" meta_snippetCategory="10_입력폼" meta_snippetKeyComponent="true" meta_snippetName="10_01 InputBox"
    					placeholder="" style="width:150px;margin-left: 10px;margin-right: 10px;" ev:onkeydown="scwin.ui_id_onkeydown" ref="data:dma_login.id">
    				</xf:input>
    				<w2:span id="" label="패스워드: " meta_snippetCategory="10_입력폼" meta_snippetKeyComponent="true"
    					meta_snippetName="10_16 출력텍스트" style="">
    				</w2:span>
    				<xf:input class="" id="ui_password" meta_snippetCategory="10_입력폼" meta_snippetKeyComponent="true" meta_snippetName="10_01 InputBox"
    					placeholder="" style="width:150px;margin-left: 10px;margin-right: 10px;" ev:onkeydown="scwin.ui_password_onkeydown" ref="data:dma_login.pw">
    				</xf:input>
    				<xf:trigger class="btn_cm" id="btn_login" meta_snippetCategory="08_버튼" meta_snippetKeyComponent="true"
    					meta_snippetName="8_01 기본버튼" style="" type="button" ev:onclick="scwin.btn_login_onclick">
    					<xf:label><![CDATA[로그인]]></xf:label>
    				</xf:trigger>
    			</xf:group>
    			<xf:group class="btn_schbox" id="" style="">
    			</xf:group>
    		</xf:group>
    	</xf:group>
    </body>
</html>
